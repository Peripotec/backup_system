/* ===== NETBOX-STYLE DARK MODE ===== */

/* Paleta NetBox Dark */
[data-theme="dark"] {
    --nb-bg-darker: #1a1a2e;
    --nb-bg-dark: #16213e;
    --nb-bg-card: #1f2937;
    --nb-bg-input: #374151;
    --nb-border: #4b5563;
    --nb-text: #e5e7eb;
    --nb-text-muted: #9ca3af;
    --nb-primary: #64b5f6;
    --nb-success: #81c784;
    --nb-warning: #fff176;
    --nb-danger: #e57373;
    --nb-info: #4dd0e1;

    /* Override base */
    --bg-body: var(--nb-bg-darker);
    --bg-card: var(--nb-bg-card);
    --text-primary: var(--nb-text);
    --text-muted: var(--nb-text-muted);
    --border-color: var(--nb-border);
}

/* === GLOBAL === */
[data-theme="dark"] body {
    background-color: var(--nb-bg-darker);
    color: var(--nb-text);
}

/* === CARDS === */
[data-theme="dark"] .card {
    background-color: var(--nb-bg-card);
    border-color: var(--nb-border);
}

[data-theme="dark"] .card-header {
    background-color: var(--nb-bg-dark) !important;
    border-color: var(--nb-border);
    color: var(--nb-text);
}

[data-theme="dark"] .card-body {
    background-color: var(--nb-bg-card);
}

[data-theme="dark"] .card-footer {
    background-color: var(--nb-bg-dark);
    border-color: var(--nb-border);
}

/* === TABLES === */
[data-theme="dark"] .table {
    --bs-table-bg: var(--nb-bg-card);
    --bs-table-color: var(--nb-text);
    --bs-table-border-color: var(--nb-border);
}

[data-theme="dark"] .table thead th {
    background-color: var(--nb-bg-dark) !important;
    color: var(--nb-text) !important;
    border-color: var(--nb-border) !important;
}

[data-theme="dark"] .table tbody td {
    color: var(--nb-text);
    border-color: var(--nb-border);
}

[data-theme="dark"] .table-striped>tbody>tr:nth-of-type(odd) {
    background-color: rgba(255, 255, 255, 0.02);
}

[data-theme="dark"] .table-hover>tbody>tr:hover {
    background-color: rgba(255, 255, 255, 0.05);
}

[data-theme="dark"] .table-secondary,
[data-theme="dark"] tr.table-secondary {
    background-color: var(--nb-bg-dark) !important;
    color: var(--nb-text) !important;
}

[data-theme="dark"] .table-dark {
    background-color: var(--nb-bg-darker) !important;
}

/* === FORMS === */
[data-theme="dark"] .form-control,
[data-theme="dark"] .form-select {
    background-color: var(--nb-bg-input) !important;
    border-color: var(--nb-border) !important;
    color: var(--nb-text) !important;
}

[data-theme="dark"] .form-control:focus,
[data-theme="dark"] .form-select:focus {
    border-color: var(--nb-primary);
    box-shadow: 0 0 0 0.2rem rgba(100, 181, 246, 0.25);
}

[data-theme="dark"] .form-control::placeholder {
    color: var(--nb-text-muted);
}

[data-theme="dark"] .form-label,
[data-theme="dark"] label {
    color: var(--nb-text);
}

[data-theme="dark"] .form-text,
[data-theme="dark"] .text-muted {
    color: var(--nb-text-muted) !important;
}

[data-theme="dark"] .form-check-input {
    background-color: var(--nb-bg-input);
    border-color: var(--nb-border);
}

[data-theme="dark"] .form-select option {
    background-color: var(--nb-bg-card);
    color: var(--nb-text);
}

/* === BUTTONS === */
[data-theme="dark"] .btn-primary {
    background-color: var(--nb-primary);
    border-color: var(--nb-primary);
    color: #ffffff;
}

[data-theme="dark"] .btn-secondary {
    background-color: var(--nb-bg-input);
    border-color: var(--nb-border);
    color: var(--nb-text);
}

[data-theme="dark"] .btn-light,
[data-theme="dark"] .btn-white {
    background-color: var(--nb-bg-input);
    border-color: var(--nb-border);
    color: var(--nb-text);
}

[data-theme="dark"] .btn-outline-primary {
    color: var(--nb-primary);
    border-color: var(--nb-primary);
}

[data-theme="dark"] .btn-outline-secondary {
    color: var(--nb-text-muted);
    border-color: var(--nb-border);
}

[data-theme="dark"] .btn-outline-primary:hover {
    background-color: var(--nb-primary);
    color: #1a1a2e;
}

[data-theme="dark"] .btn-success {
    background-color: var(--nb-success);
    border-color: var(--nb-success);
    color: #1a1a2e;
}

[data-theme="dark"] .btn-danger {
    background-color: var(--nb-danger);
    border-color: var(--nb-danger);
    color: #1a1a2e;
}

[data-theme="dark"] .btn-warning {
    background-color: var(--nb-warning);
    border-color: var(--nb-warning);
    color: #1a1a2e;
}

[data-theme="dark"] .btn-info {
    background-color: var(--nb-info);
    border-color: var(--nb-info);
    color: #1a1a2e;
}

/* === BADGES === */
[data-theme="dark"] .badge.bg-primary {
    background-color: rgba(100, 181, 246, 0.2) !important;
    color: var(--nb-primary) !important;
}

[data-theme="dark"] .badge.bg-secondary {
    background-color: rgba(156, 163, 175, 0.2) !important;
    color: var(--nb-text-muted) !important;
}

[data-theme="dark"] .badge.bg-success {
    background-color: rgba(129, 199, 132, 0.2) !important;
    color: var(--nb-success) !important;
}

[data-theme="dark"] .badge.bg-danger {
    background-color: rgba(229, 115, 115, 0.2) !important;
    color: var(--nb-danger) !important;
}

[data-theme="dark"] .badge.bg-warning {
    background-color: rgba(255, 241, 118, 0.2) !important;
    color: var(--nb-warning) !important;
}

[data-theme="dark"] .badge.bg-info {
    background-color: rgba(77, 208, 225, 0.2) !important;
    color: var(--nb-info) !important;
}

[data-theme="dark"] .badge.bg-light {
    background-color: rgba(255, 255, 255, 0.1) !important;
    color: var(--nb-text) !important;
}

[data-theme="dark"] .badge.bg-dark {
    background-color: var(--nb-bg-dark) !important;
    color: var(--nb-text) !important;
}

/* === ALERTS === */
[data-theme="dark"] .alert-primary {
    background-color: rgba(100, 181, 246, 0.1);
    border-color: rgba(100, 181, 246, 0.3);
    color: var(--nb-primary);
}

[data-theme="dark"] .alert-success {
    background-color: rgba(129, 199, 132, 0.1);
    border-color: rgba(129, 199, 132, 0.3);
    color: var(--nb-success);
}

[data-theme="dark"] .alert-warning {
    background-color: rgba(255, 241, 118, 0.1);
    border-color: rgba(255, 241, 118, 0.3);
    color: var(--nb-warning);
}

[data-theme="dark"] .alert-danger {
    background-color: rgba(229, 115, 115, 0.1);
    border-color: rgba(229, 115, 115, 0.3);
    color: var(--nb-danger);
}

[data-theme="dark"] .alert-info {
    background-color: rgba(77, 208, 225, 0.1);
    border-color: rgba(77, 208, 225, 0.3);
    color: var(--nb-info);
}

/* === MODALS === */
[data-theme="dark"] .modal-content {
    background-color: var(--nb-bg-card);
    border-color: var(--nb-border);
    color: var(--nb-text);
}

[data-theme="dark"] .modal-header {
    background-color: var(--nb-bg-dark);
    border-color: var(--nb-border);
}

[data-theme="dark"] .modal-footer {
    background-color: var(--nb-bg-dark);
    border-color: var(--nb-border);
}

/* === DROPDOWNS === */
[data-theme="dark"] .dropdown-menu {
    background-color: var(--nb-bg-card);
    border-color: var(--nb-border);
}

[data-theme="dark"] .dropdown-item {
    color: var(--nb-text);
}

[data-theme="dark"] .dropdown-item:hover,
[data-theme="dark"] .dropdown-item:focus {
    background-color: var(--nb-bg-input);
    color: var(--nb-text);
}

[data-theme="dark"] .dropdown-divider {
    border-color: var(--nb-border);
}

/* === LIST GROUPS === */
[data-theme="dark"] .list-group-item {
    background-color: var(--nb-bg-card);
    border-color: var(--nb-border);
    color: var(--nb-text);
}

[data-theme="dark"] .list-group-item:hover {
    background-color: var(--nb-bg-input);
}

/* === NAV TABS === */
[data-theme="dark"] .nav-tabs {
    border-color: var(--nb-border);
}

[data-theme="dark"] .nav-tabs .nav-link {
    color: var(--nb-text-muted);
}

[data-theme="dark"] .nav-tabs .nav-link:hover {
    border-color: var(--nb-border);
}

[data-theme="dark"] .nav-tabs .nav-link.active {
    background-color: var(--nb-bg-card);
    border-color: var(--nb-border);
    color: var(--nb-text);
}

/* === PROGRESS === */
[data-theme="dark"] .progress {
    background-color: var(--nb-bg-input);
}

/* === BREADCRUMB === */
[data-theme="dark"] .breadcrumb {
    background-color: transparent;
}

[data-theme="dark"] .breadcrumb-item a {
    color: var(--nb-primary);
}

[data-theme="dark"] .breadcrumb-item.active {
    color: var(--nb-text-muted);
}

/* === CODE === */
[data-theme="dark"] code {
    background-color: var(--nb-bg-input);
    color: var(--nb-info);
}

[data-theme="dark"] pre {
    background-color: var(--nb-bg-darker);
    border-color: var(--nb-border);
    color: var(--nb-text);
}

/* === ACCORDION === */
[data-theme="dark"] .accordion-item {
    background-color: var(--nb-bg-card);
    border-color: var(--nb-border);
}

[data-theme="dark"] .accordion-button {
    background-color: var(--nb-bg-dark);
    color: var(--nb-text);
}

[data-theme="dark"] .accordion-button:not(.collapsed) {
    background-color: var(--nb-bg-input);
    color: var(--nb-primary);
}

/* === SPECIFIC COMPONENTS === */

/* File explorer */
[data-theme="dark"] .file-explorer,
[data-theme="dark"] .file-list,
[data-theme="dark"] .file-preview {
    background-color: var(--nb-bg-card);
    color: var(--nb-text);
}

/* Filter bar */
[data-theme="dark"] .filter-bar,
[data-theme="dark"] #filter-bar-container {
    background-color: var(--nb-bg-dark);
}

/* Filter chips */
[data-theme="dark"] .filter-chip {
    background-color: var(--nb-bg-input);
    color: var(--nb-text);
}

[data-theme="dark"] .active-filters {
    background-color: var(--nb-bg-dark);
    border-color: var(--nb-border);
}

/* Status indicators */
[data-theme="dark"] .status-indicator {
    color: var(--nb-text);
}

/* Criticality pills */
[data-theme="dark"] .crit-pill {
    border: 1px solid currentColor;
}

[data-theme="dark"] .crit-pill.crit-alta {
    background-color: rgba(229, 115, 115, 0.15);
    color: var(--nb-danger);
}

[data-theme="dark"] .crit-pill.crit-media {
    background-color: rgba(255, 241, 118, 0.15);
    color: var(--nb-warning);
}

[data-theme="dark"] .crit-pill.crit-baja {
    background-color: rgba(129, 199, 132, 0.15);
    color: var(--nb-success);
}

/* Tooltips */
[data-theme="dark"] .tooltip-inner {
    background-color: var(--nb-bg-dark);
    color: var(--nb-text);
}

/* Popovers */
[data-theme="dark"] .popover {
    background-color: var(--nb-bg-card);
    border-color: var(--nb-border);
}

[data-theme="dark"] .popover-body {
    color: var(--nb-text);
}

/* Borders and fieldsets */
[data-theme="dark"] .border {
    border-color: var(--nb-border) !important;
}

[data-theme="dark"] fieldset,
[data-theme="dark"] .p-3.border {
    background-color: rgba(0, 0, 0, 0.2);
}

/* Icons */
[data-theme="dark"] .bi.text-primary {
    color: var(--nb-primary) !important;
}

[data-theme="dark"] .bi.text-success {
    color: var(--nb-success) !important;
}

[data-theme="dark"] .bi.text-danger {
    color: var(--nb-danger) !important;
}

[data-theme="dark"] .bi.text-warning {
    color: var(--nb-warning) !important;
}

[data-theme="dark"] .bi.text-info {
    color: var(--nb-info) !important;
}

/* Clickable IP */
[data-theme="dark"] .clickable-ip {
    color: var(--nb-info);
    background-color: var(--nb-bg-input);
}

/* Sidebar adjustments */
[data-theme="dark"] .sidebar-nav .nav-link.active {
    background-color: rgba(100, 181, 246, 0.2);
}

/* Vendor text */
[data-theme="dark"] .vendor-text {
    color: var(--nb-text);
}

/* ===== FIXES ADICIONALES ===== */

/* Nav Pills - tabs de explorador */
[data-theme="dark"] .nav-pills .nav-link {
    color: var(--nb-text-muted);
    background-color: transparent;
}

[data-theme="dark"] .nav-pills .nav-link:hover {
    background-color: var(--nb-bg-input);
    color: var(--nb-text);
}

[data-theme="dark"] .nav-pills .nav-link.active {
    background-color: var(--nb-bg-input) !important;
    color: var(--nb-primary) !important;
}

/* Backgrounds generales con alta especificidad */
[data-theme="dark"] .bg-light {
    background-color: var(--nb-bg-dark) !important;
    color: var(--nb-text) !important;
}

[data-theme="dark"] .bg-secondary {
    background-color: var(--nb-bg-input) !important;
    color: var(--nb-text) !important;
}

[data-theme="dark"] .bg-white {
    background-color: var(--nb-bg-card) !important;
}

[data-theme="dark"] .bg-body {
    background-color: var(--nb-bg-darker) !important;
}

/* Filas de tabla con background claro */
[data-theme="dark"] tr.bg-light,
[data-theme="dark"] tr.table-light,
[data-theme="dark"] tr.bg-secondary,
[data-theme="dark"] .table tr.bg-light,
[data-theme="dark"] .table tr.table-light,
[data-theme="dark"] .table-light {
    background-color: var(--nb-bg-dark) !important;
    color: var(--nb-text) !important;
}

[data-theme="dark"] tr.bg-light td,
[data-theme="dark"] tr.table-light td,
[data-theme="dark"] tr.table-secondary td {
    background-color: inherit !important;
    color: inherit !important;
}

/* Input groups */
[data-theme="dark"] .input-group-text {
    background-color: var(--nb-bg-dark);
    border-color: var(--nb-border);
    color: var(--nb-text);
}

[data-theme="dark"] .input-group .form-control,
[data-theme="dark"] .input-group .form-select {
    background-color: var(--nb-bg-input) !important;
    border-color: var(--nb-border) !important;
    color: var(--nb-text) !important;
}

/* Text colors con alta especificidad */
[data-theme="dark"] .text-dark {
    color: var(--nb-text) !important;
}

[data-theme="dark"] .text-body {
    color: var(--nb-text) !important;
}

[data-theme="dark"] .text-secondary {
    color: var(--nb-text-muted) !important;
}

/* Links */
[data-theme="dark"] a:not(.btn):not(.nav-link):not(.dropdown-item) {
    color: var(--nb-primary);
}

[data-theme="dark"] a:not(.btn):not(.nav-link):not(.dropdown-item):hover {
    color: #90caf9;
}

/* Botón close */
[data-theme="dark"] .btn-close {
    filter: invert(1);
}

/* Offcanvas */
[data-theme="dark"] .offcanvas {
    background-color: var(--nb-bg-card);
    color: var(--nb-text);
}

[data-theme="dark"] .offcanvas-header {
    border-color: var(--nb-border);
}

/* Pagination */
[data-theme="dark"] .page-link {
    background-color: var(--nb-bg-card);
    border-color: var(--nb-border);
    color: var(--nb-text);
}

[data-theme="dark"] .page-link:hover {
    background-color: var(--nb-bg-input);
    color: var(--nb-primary);
}

[data-theme="dark"] .page-item.active .page-link {
    background-color: var(--nb-primary);
    border-color: var(--nb-primary);
    color: #1a1a2e;
}

[data-theme="dark"] .page-item.disabled .page-link {
    background-color: var(--nb-bg-dark);
    color: var(--nb-text-muted);
}

/* Spinners */
[data-theme="dark"] .spinner-border {
    color: var(--nb-primary);
}

/* Hr */
[data-theme="dark"] hr {
    border-color: var(--nb-border);
    opacity: 0.5;
}

/* Figure captions */
[data-theme="dark"] .figure-caption {
    color: var(--nb-text-muted);
}

/* Small y caption */
[data-theme="dark"] small,
[data-theme="dark"] .small {
    color: var(--nb-text-muted);
}

/* Lead text */
[data-theme="dark"] .lead {
    color: var(--nb-text);
}

/* Blockquote */
[data-theme="dark"] .blockquote-footer {
    color: var(--nb-text-muted);
}

/* Toast */
[data-theme="dark"] .toast {
    background-color: var(--nb-bg-card);
    color: var(--nb-text);
    border-color: var(--nb-border);
}

[data-theme="dark"] .toast-header {
    background-color: var(--nb-bg-dark);
    color: var(--nb-text);
    border-color: var(--nb-border);
}

/* Tables con clases especiales */
[data-theme="dark"] .table-responsive {
    background-color: transparent;
}

[data-theme="dark"] .table> :not(caption)>*>* {
    background-color: inherit;
    color: inherit;
}

/* Fix específico para group headers en tablas */
[data-theme="dark"] tbody tr[class*="group"],
[data-theme="dark"] tbody tr.group-header,
[data-theme="dark"] tbody tr[style*="background"] {
    background-color: var(--nb-bg-dark) !important;
}

/* Fix para cualquier elemento con inline style de background blanco */
[data-theme="dark"] [style*="background-color: white"],
[data-theme="dark"] [style*="background-color:#fff"],
[data-theme="dark"] [style*="background-color: #fff"],
[data-theme="dark"] [style*="background: white"],
[data-theme="dark"] [style*="background:#fff"],
[data-theme="dark"] [style*="background: #fff"] {
    background-color: var(--nb-bg-card) !important;
}

/* Fix para elementos con background inline rgb */
[data-theme="dark"] [style*="background-color: rgb(255"],
[data-theme="dark"] [style*="background: rgb(255"] {
    background-color: var(--nb-bg-card) !important;
}

/* Fix para rounded-pill badges sin clase bg especifica */
[data-theme="dark"] .badge.rounded-pill:not([class*="bg-"]) {
    background-color: var(--nb-bg-input) !important;
    color: var(--nb-text) !important;
}

/* Placeholder text en todos los inputs */
[data-theme="dark"] input::placeholder,
[data-theme="dark"] textarea::placeholder,
[data-theme="dark"] .form-control::placeholder {
    color: var(--nb-text-muted) !important;
    opacity: 0.7;
}

/* Fix para selects dentro de forms */
[data-theme="dark"] select,
[data-theme="dark"] input[type="text"],
[data-theme="dark"] input[type="email"],
[data-theme="dark"] input[type="password"],
[data-theme="dark"] input[type="search"],
[data-theme="dark"] input[type="number"],
[data-theme="dark"] textarea {
    background-color: var(--nb-bg-input) !important;
    color: var(--nb-text) !important;
    border-color: var(--nb-border) !important;
}

/* Table striped con más especificidad */
[data-theme="dark"] .table-striped tbody tr:nth-of-type(odd)>* {
    background-color: rgba(255, 255, 255, 0.02);
    color: var(--nb-text);
}

[data-theme="dark"] .table-striped tbody tr:nth-of-type(even)>* {
    background-color: var(--nb-bg-card);
    color: var(--nb-text);
}

/* ===== FIXES ESPECÍFICOS POR TEMPLATE ===== */

/* === BTN-CHECK (files.html tabs) === */
/* Cuando btn-check está :checked, Bootstrap aplica estilos al label siguiente */
[data-theme="dark"] .btn-check:checked+.btn-outline-primary {
    background-color: var(--nb-bg-input) !important;
    border-color: var(--nb-primary) !important;
    color: var(--nb-primary) !important;
}

[data-theme="dark"] .btn-check:checked+.btn-outline-secondary {
    background-color: var(--nb-bg-input) !important;
    border-color: var(--nb-border) !important;
    color: var(--nb-text) !important;
}

[data-theme="dark"] .btn-check+.btn-outline-primary {
    color: var(--nb-text-muted);
    border-color: var(--nb-border);
}

[data-theme="dark"] .btn-check+.btn-outline-primary:hover {
    background-color: rgba(100, 181, 246, 0.1);
    color: var(--nb-primary);
}

/* === TABLE-SECONDARY (localidades.html group rows) === */
/* Bootstrap 5 usa CSS variables en tables, hay que sobrescribirlas */
[data-theme="dark"] .table-secondary {
    --bs-table-bg: var(--nb-bg-dark) !important;
    --bs-table-color: var(--nb-text) !important;
    --bs-table-border-color: var(--nb-border) !important;
    --bs-table-striped-bg: var(--nb-bg-dark) !important;
    --bs-table-striped-color: var(--nb-text) !important;
    --bs-table-hover-bg: rgba(255, 255, 255, 0.05) !important;
    --bs-table-hover-color: var(--nb-text) !important;
}

[data-theme="dark"] tr.table-secondary,
[data-theme="dark"] .table>tbody>tr.table-secondary {
    background-color: var(--nb-bg-dark) !important;
}

[data-theme="dark"] tr.table-secondary>td,
[data-theme="dark"] tr.table-secondary>th,
[data-theme="dark"] .table>tbody>tr.table-secondary>td {
    background-color: var(--nb-bg-dark) !important;
    color: var(--nb-text) !important;
}

/* === BREADCRUMB BG-LIGHT (files.html) === */
[data-theme="dark"] .breadcrumb.bg-light,
[data-theme="dark"] ol.breadcrumb.bg-light {
    background-color: var(--nb-bg-dark) !important;
}

/* === TOOLBAR BG-LIGHT (groups.html search bar) === */
[data-theme="dark"] .bg-light.border-bottom,
[data-theme="dark"] div.bg-light {
    background-color: var(--nb-bg-dark) !important;
    border-color: var(--nb-border) !important;
}

/* === BADGE BG-SECONDARY specifico === */
/* Mayor especificidad para badges dentro de tablas */
[data-theme="dark"] .table .badge.bg-secondary,
[data-theme="dark"] td .badge.bg-secondary,
[data-theme="dark"] tr .badge.bg-secondary {
    background-color: var(--nb-bg-input) !important;
    color: var(--nb-text) !important;
}

/* === TABLE-LIGHT === */
[data-theme="dark"] .table-light {
    --bs-table-bg: var(--nb-bg-dark) !important;
    --bs-table-color: var(--nb-text) !important;
    --bs-table-border-color: var(--nb-border) !important;
}

[data-theme="dark"] tr.table-light>td,
[data-theme="dark"] tr.table-light>th {
    background-color: var(--nb-bg-dark) !important;
    color: var(--nb-text) !important;
}

/* === CARD-HEADER con colores === */
[data-theme="dark"] .card-header.bg-primary {
    background-color: rgba(100, 181, 246, 0.2) !important;
    color: var(--nb-primary) !important;
}

[data-theme="dark"] .card-header.bg-success {
    background-color: rgba(129, 199, 132, 0.2) !important;
    color: var(--nb-success) !important;
}

[data-theme="dark"] .card-header.bg-warning {
    background-color: rgba(255, 241, 118, 0.2) !important;
    color: var(--nb-warning) !important;
}

[data-theme="dark"] .card-header.bg-danger {
    background-color: rgba(229, 115, 115, 0.2) !important;
    color: var(--nb-danger) !important;
}

[data-theme="dark"] .card-header.bg-info {
    background-color: rgba(77, 208, 225, 0.2) !important;
    color: var(--nb-info) !important;
}

[data-theme="dark"] .card-header.bg-secondary {
    background-color: var(--nb-bg-dark) !important;
    color: var(--nb-text) !important;
}

/* === MODAL HEADERS con colores === */
[data-theme="dark"] .modal-header.bg-success,
[data-theme="dark"] .modal-header.bg-primary,
[data-theme="dark"] .modal-header.bg-warning,
[data-theme="dark"] .modal-header.bg-danger {
    color: var(--nb-text) !important;
}

[data-theme="dark"] .modal-header.bg-success {
    background-color: rgba(129, 199, 132, 0.3) !important;
}

[data-theme="dark"] .modal-header.bg-danger {
    background-color: rgba(229, 115, 115, 0.3) !important;
}

/* === LIST-GROUP-ITEM dentro de card === */
[data-theme="dark"] .card .list-group-item,
[data-theme="dark"] .list-group-flush .list-group-item {
    background-color: var(--nb-bg-card) !important;
    border-color: var(--nb-border) !important;
    color: var(--nb-text) !important;
}

[data-theme="dark"] .list-group-item:hover,
[data-theme="dark"] .list-group-item.file-item:hover {
    background-color: var(--nb-bg-input) !important;
}

/* === NAV-TABS dentro de cards (groups.html) === */
[data-theme="dark"] .card-header .nav-tabs {
    border-bottom-color: transparent;
}

[data-theme="dark"] .card-header .nav-tabs .nav-link {
    color: var(--nb-text-muted);
    border-color: transparent;
}

[data-theme="dark"] .card-header .nav-tabs .nav-link:hover {
    border-color: var(--nb-border);
}

[data-theme="dark"] .card-header .nav-tabs .nav-link.active {
    background-color: var(--nb-bg-card);
    border-color: var(--nb-border) var(--nb-border) var(--nb-bg-card);
    color: var(--nb-text);
}

/* === ALERT-INFO (tips) === */
[data-theme="dark"] .alert-info {
    background-color: rgba(77, 208, 225, 0.1) !important;
    border-color: rgba(77, 208, 225, 0.3) !important;
    color: var(--nb-info) !important;
}

/* === PRE/CODE en file viewer === */
[data-theme="dark"] pre.file-content,
[data-theme="dark"] .file-content {
    background-color: var(--nb-bg-darker) !important;
    color: var(--nb-text) !important;
}

/* === Asegurar que TODOS los td/th en tables hereden colores === */
[data-theme="dark"] .table td,
[data-theme="dark"] .table th {
    color: var(--nb-text);
    border-color: var(--nb-border);
}

/* ===== FIXES DE AUDITORÍA VISUAL - 2026-01-14 ===== */

/* === LOCALIDADES: Filas de grupo table-secondary === */
/* Bootstrap 5 usa CSS custom properties, hay que sobrescribirlas todas */
[data-theme="dark"] tr.table-secondary,
[data-theme="dark"] .table tr.table-secondary,
[data-theme="dark"] tbody tr.table-secondary {
    --bs-table-bg: #1e3a5f !important;
    --bs-table-color: var(--nb-text) !important;
    --bs-table-border-color: var(--nb-border) !important;
    background-color: #1e3a5f !important;
    color: var(--nb-text) !important;
}

[data-theme="dark"] tr.table-secondary>td,
[data-theme="dark"] tr.table-secondary td {
    --bs-table-bg-state: #1e3a5f !important;
    background-color: #1e3a5f !important;
    color: var(--nb-text) !important;
}

/* === VENDORS: Badge y nombres con color fijo === */
[data-theme="dark"] .vendor-badge {
    background-color: #374151 !important;
    color: var(--nb-text) !important;
}

[data-theme="dark"] .vendor-name,
[data-theme="dark"] .model-name,
[data-theme="dark"] .model-info,
[data-theme="dark"] .model-item {
    color: var(--nb-text) !important;
}

/* === ROLES MODAL: Labels de permisos en negro === */
[data-theme="dark"] .modal-body .form-label,
[data-theme="dark"] .modal-body .form-check-label,
[data-theme="dark"] .modal-body strong,
[data-theme="dark"] .modal-body label {
    color: var(--nb-text) !important;
}

[data-theme="dark"] .modal-body .form-text {
    color: var(--nb-text-muted) !important;
}

/* Card dentro de modal (permisos grid) */
[data-theme="dark"] .modal-body .card {
    background-color: var(--nb-bg-dark) !important;
    border-color: var(--nb-border) !important;
}

/* Emoji picker en modal de roles */
[data-theme="dark"] .emoji-picker {
    background-color: var(--nb-bg-card) !important;
}

[data-theme="dark"] .emoji-option:hover {
    background-color: rgba(255, 255, 255, 0.1) !important;
}

/* === SETTINGS/GENERAL: Labels y form text === */
[data-theme="dark"] .form-label,
[data-theme="dark"] label:not(.btn) {
    color: var(--nb-text) !important;
}

[data-theme="dark"] .form-text,
[data-theme="dark"] .text-muted,
[data-theme="dark"] small.text-muted {
    color: var(--nb-text-muted) !important;
}

/* === GROUPS/DASHBOARD: Barras bg-light === */
[data-theme="dark"] .bg-light {
    background-color: var(--nb-bg-dark) !important;
    color: var(--nb-text) !important;
}

/* === Dashboard: Jobs sidebar === */
[data-theme="dark"] .jobs-sidebar {
    background-color: var(--nb-bg-dark) !important;
    border-color: var(--nb-border) !important;
}

[data-theme="dark"] .sidebar-header {
    background-color: var(--nb-bg-darker) !important;
    border-color: var(--nb-border) !important;
}

[data-theme="dark"] .sidebar-title,
[data-theme="dark"] .filter-label {
    color: var(--nb-text-muted) !important;
}

/* === Modal de backup: bg-light filter bar === */
[data-theme="dark"] .modal-body .bg-light {
    background-color: var(--nb-bg-dark) !important;
}

/* ===== FIXES ADICIONALES - 2026-01-14 ===== */

/* === DASHBOARD: Sidebar Body (filtros laterales) === */
[data-theme="dark"] .sidebar-body {
    background-color: var(--nb-bg-dark) !important;
    color: var(--nb-text) !important;
}

[data-theme="dark"] .filter-group {
    border-color: var(--nb-border) !important;
}

/* === GROUPS: Tree-View (grupos automáticos) === */
[data-theme="dark"] .tree-view {
    background-color: var(--nb-bg-card) !important;
    color: var(--nb-text) !important;
}

[data-theme="dark"] .tree-view__section-header {
    color: var(--nb-text) !important;
}

[data-theme="dark"] .tree-view__node-header {
    color: var(--nb-text) !important;
}

[data-theme="dark"] .tree-view__node-label {
    color: var(--nb-text) !important;
}

[data-theme="dark"] .tree-view__node-count {
    color: var(--nb-text-muted) !important;
}

[data-theme="dark"] .tree-view__toggle {
    color: var(--nb-text-muted) !important;
}

[data-theme="dark"] .tree-view__device {
    background-color: var(--nb-bg-dark) !important;
    color: var(--nb-text) !important;
    border-color: var(--nb-border) !important;
}

[data-theme="dark"] .tree-view__device-name {
    color: var(--nb-text) !important;
}

[data-theme="dark"] .tree-view__device-ip {
    color: var(--nb-text-muted) !important;
}

[data-theme="dark"] .tree-view__device-grupo {
    color: var(--nb-text-muted) !important;
}

[data-theme="dark"] .tree-view__children {
    background-color: var(--nb-bg-dark) !important;
}

/* === VENDORS: Card spans con texto negro === */
[data-theme="dark"] .vendor-card {
    background-color: var(--nb-bg-card) !important;
    border-color: var(--nb-border) !important;
}

[data-theme="dark"] .vendor-card span,
[data-theme="dark"] .vendor-header span,
[data-theme="dark"] .vendor-name span {
    color: var(--nb-text) !important;
}

[data-theme="dark"] .models-list {
    border-color: var(--nb-border) !important;
}

[data-theme="dark"] .model-item {
    border-color: var(--nb-border) !important;
}

[data-theme="dark"] .model-name,
[data-theme="dark"] .model-type,
[data-theme="dark"] .model-desc {
    color: var(--nb-text) !important;
}

[data-theme="dark"] .model-desc {
    color: var(--nb-text-muted) !important;
}

/* === SETTINGS: Headings h5 y h6 negros === */
[data-theme="dark"] h5,
[data-theme="dark"] h6,
[data-theme="dark"] .tab-pane h5,
[data-theme="dark"] .tab-pane h6 {
    color: var(--nb-text) !important;
}

/* === SETTINGS: Schedule sections === */
[data-theme="dark"] .schedule-section h6 {
    color: var(--nb-text) !important;
}

/* === General: Todos los headings === */
[data-theme="dark"] h1,
[data-theme="dark"] h2,
[data-theme="dark"] h3,
[data-theme="dark"] h4 {
    color: var(--nb-text) !important;
}

/* === HR separadores === */
[data-theme="dark"] hr {
    border-color: var(--nb-border) !important;
    opacity: 0.5;
}

/* === Alert info con herencia === */
[data-theme="dark"] .alert-info strong {
    color: var(--nb-info) !important;
}